<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Properties | RentEase</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex">

  <!-- Sidebar -->
  <aside class="w-64 bg-white shadow-md min-h-screen p-6 hidden md:block">
    <h1 class="text-2xl font-bold text-blue-600 mb-6">RentEase</h1>
    <nav id="sidebar-nav" class="space-y-4">
      <a href="home.html" class="block text-gray-700 hover:text-blue-600">🔍 Search Properties</a>
      <a href="add-property.html" class="block text-gray-700 hover:text-blue-600">➕ Add Property</a>
      <a href="my-properties.html" class="block text-blue-600 font-semibold">📋 My Properties</a>
      <a href="add-homestay.html" class="block text-gray-700 hover:text-blue-600">🏡 Add Homestay</a>
      <a id="auth-link" href="login.html" class="block text-gray-700 hover:text-blue-600">🔑 Login</a>
    </nav>

    <div class="mt-10 text-sm text-gray-500">
      <p>📍 Active Cities: <span class="font-semibold">25+</span></p>
      <p>🏘️ Listed Properties: <span class="font-semibold">1000+</span></p>
    </div>
  </aside>

  <!-- Main Section -->
  <main class="flex-1 p-6">
    <div class="max-w-7xl mx-auto">
      <h2 class="text-3xl font-semibold text-gray-800 mb-6">📌 My Properties</h2>

      <!-- Property Cards Container -->
      <div id="properties-container"
        class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- JS will inject cards here -->
      </div>
    </div>
  </main>

  <!-- 👋 Username Display (Bottom-Right Corner) -->
  <div id="user-greeting" class="fixed bottom-4 right-4 bg-white shadow-md rounded-full px-4 py-2 text-gray-700 font-medium hidden">
    👋 <span id="user-name-display"></span>
  </div>

  <!-- Edit Modal -->
  <div id="editModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-lg shadow-lg w-full max-w-3xl p-6 relative overflow-y-auto max-h-[90vh]">
      <button id="closeModal" class="absolute top-2 right-2 text-gray-500 hover:text-gray-700">✖</button>
      <h2 class="text-xl font-semibold mb-4 text-gray-800">Edit Property</h2>

      <form id="editForm" class="space-y-4">

        <input type="text" name="title" placeholder="Property Title"
          class="w-full border p-2 rounded" required />

        <select name="type" class="w-full border p-2 rounded" required>
          <option value="">Select Type</option>
          <option value="PG">PG</option>
          <option value="Flat">Flat</option>
          <option value="Apartment">Apartment</option>
          <option value="Homestay">Homestay</option>
          <option value="Villa">Villa</option>
          <option value="Other">Other</option>
        </select>

        <input type="text" name="location" placeholder="Location"
          class="w-full border p-2 rounded" required />

        <div class="grid grid-cols-2 gap-4">
          <input type="number" name="price" placeholder="Price (₹)" class="border p-2 rounded" required />
          <input type="number" name="deposit" placeholder="Deposit (₹)" class="border p-2 rounded" />
        </div>

        <textarea name="description" placeholder="Description"
          class="w-full border p-2 rounded"></textarea>

        <div class="grid grid-cols-3 gap-4">
          <input type="number" name="beds" placeholder="Beds" class="border p-2 rounded" />
          <input type="number" name="baths" placeholder="Baths" class="border p-2 rounded" />
          <input type="text" name="sqFt" placeholder="SqFt" class="border p-2 rounded" />
        </div>

        <div class="grid grid-cols-2 gap-4">
          <select name="gender" class="border p-2 rounded">
            <option value="Any">Any</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Family">Family</option>
          </select>
          <select name="furnishing" class="border p-2 rounded">
            <option value="">Select Furnishing</option>
            <option value="Furnished">Furnished</option>
            <option value="Semi-Furnished">Semi-Furnished</option>
            <option value="Unfurnished">Unfurnished</option>
          </select>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <input type="text" name="phone" placeholder="Phone" class="border p-2 rounded" />
        </div>

        <div>
          <label class="font-semibold">Amenities:</label>
          <div class="grid grid-cols-2 gap-2 mt-2">
            <label><input type="checkbox" name="amenities" value="WiFi"> WiFi</label>
            <label><input type="checkbox" name="amenities" value="Parking"> Parking</label>
            <label><input type="checkbox" name="amenities" value="AC"> AC</label>
            <label><input type="checkbox" name="amenities" value="TV"> TV</label>
            <label><input type="checkbox" name="amenities" value="Fridge"> Fridge</label>
            <label><input type="checkbox" name="amenities" value="Washing Machine"> Washing Machine</label>
          </div>
        </div>

        <label class="block">Update Images:</label>
        <input type="file" name="images" multiple class="w-full border p-2 rounded" />
        <div id="imagePreview" class="flex flex-wrap gap-2 mt-2"></div>

        <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition">
          Save Changes
        </button>
      </form>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    // ✅ Protect My Properties page
    const token = localStorage.getItem("token");
    const userName = localStorage.getItem("userName");

    if (!token) {
      alert("⚠️ Please login to view your properties.");
      window.location.href = "login.html";
    } else {
      const authLink = document.getElementById("auth-link");
      if (authLink) {
        authLink.style.display = "none";
        const nav = document.getElementById("sidebar-nav");

        // 👋 Show user greeting at bottom right instead of sidebar
        const greetingDiv = document.getElementById("user-greeting");
        const userNameDisplay = document.getElementById("user-name-display");
        userNameDisplay.textContent = userName;
        greetingDiv.classList.remove("hidden");

        // Add logout link to sidebar
        const logoutLink = document.createElement("a");
        logoutLink.href = "#";
        logoutLink.textContent = "🚪 Logout";
        logoutLink.className = "block text-red-600 font-medium hover:text-red-800";
        logoutLink.addEventListener("click", () => {
          localStorage.removeItem("token");
          localStorage.removeItem("userName");
          window.location.href = "login.html";
        });
        nav.appendChild(logoutLink);
      }
    }
  </script>

  <script src="my-properties.js"></script>
</body>
</html>
